<!DOCTYPE html>
<html lang="en-IN">
<head>
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="./assets/logox.png" type="image/x-icon">
    <script src="https://kit.fontawesome.com/80b6b65415.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="./css/_zxsp.css">
    <link rel="stylesheet" href="./css/_zxzb.css">
    <link rel="stylesheet" href="./css/zxstyle.css">
    <link rel="stylesheet" href="./css/_zxss.css">
    <title>ssify</title>
</head>
<body>
    <header id="header">
        <div class="logo" align="center"><img src="assets/logox.png" width="40px" oncontextmenu="return false;"></div>
        <nav class="active" id="myDIV">
          <ul>
            <li><a href="/" class="actives"><i class="fa fa-home fan"></i><span class="nax">Home</span></a></li>
            <li><a href="/s/" class="actives"><i class="zx zx-albums zxn"><span class="path1"></span><span class="path2"></span><span class="path3"></span><span class="path4"></span><span class="path5"></span></i><span class="nax">Home</span></a></li>
          </ul>
        </nav>
      </header>
    <div class="content_body">
      <div class="song-list">
        <div class="nevm">
          <h2 style="font-size:32px;">Hi!</h2>
          <div class="zxinp"><label for=""><i class="fas fa-search"></i></label><input type="text" id="myInput" onkeyup="InputFunction()" placeholder="Search songs" title="Type a song name"></div>
          <a href="/s/" class="zxpl"><i class="zx zx-albums zxn"><span class="path1"></span><span class="path2"></span><span class="path3"></span><span class="path4"></span><span class="path5"></span></i><span class="nax">Home</span></a>
        </div>
        <br>
        <div class="LIST-58">
          <div class="zx-bar">
            <div class="column name-column">Name</div>
            <div class="column artist-column">Artist</div>
            <div class="column clock-column"><i class="fas fa-clock"></i></div>
        </div>
        
    <ul id="myUL">
        <li><a class="songname" zx-ds="https://shorturl.at/ju046" zx-lyr="https://ssify.netlify.app/lyr/file.lyr" zx-dsn="Island" zx-dsan="Jarico" zx-dspu="https://shorturl.at/dlpN5"><div class="impxz"><i class="arrow fa fa-play playbtn0" ></i><img src="https://shorturl.at/dlpN5" alt=""></div><div class="zxnn"><span class="_zxn">Island</span><span class="_zxan">Jarico</span><span class="_zxst">3:36</span></div></a></li>
        <li><a class="songname" zx-ds="https://shorturl.at/dlvVZ" zx-lyr="" zx-dsn="Suzume no Tojimari" zx-dsan="Radwimps, Kazuma Jinnouchi" zx-dspu="https://shorturl.at/iklTW"><div class="impxz"><i class="arrow fa fa-play playbtn0"></i><img src="https://shorturl.at/iklTW"></div><div class="zxnn"><span class="_zxn">Suzume no Tojimari</span><span class="_zxan">Radwimps, Kazuma Jinnouchi</span><span class="_zxst">4:30</span></div></a></li>
        <li><a class="songname" zx-ds="https://shorturl.at/yzE08" zx-lyr="" zx-dsn='Kalaastar (From "Honey 3.0")' zx-dsan="Yo Yo Honey Singh" zx-dspu="https://shorturl.at/dfDJ3"><div class="impxz"><i class="arrow fa fa-play playbtn0"></i><img src="https://shorturl.at/dfDJ3"></div><div class="zxnn"><span class="_zxn">Kalaastar (From "Honey 3.0")</span><span class="_zxan">Yo Yo Honey Singh</span><span class="_zxst">3.27</span></div></a></li>
        <li><a class="songname" zx-ds="https://shorturl.at/hHMY5" zx-lyr="" zx-dsn="Tu Hai Kahan" zx-dsan="AUR" zx-dspu="https://shorturl.at/dgjG2"><div class="impxz"><i class="arrow fa fa-play playbtn0"></i><img src="https://shorturl.at/dgjG2"></div><div class="zxnn"><span class="_zxn">Tu Hai Kahan</span><span class="_zxan">AUR</span><span class="_zxst">4:23</span></div></a></li>
        <li><a class="songname" zx-ds="https://shorturl.at/bgyRU" zx-lyr="" zx-dsn="Chaleya" zx-dsan="Anirudh Ravichander, Arijit Singh, Shilpa Rao, Kumaar" zx-dspu="https://shorturl.at/hwFGQ"><div class="impxz"><i class="arrow fa fa-play playbtn0"></i><img src="https://shorturl.at/hwFGQ"></div><div class="zxnn"><span class="_zxn">Chaleya</span><span class="_zxan">Anirudh Ravichander, Arijit Singh, Shilpa Rao, Kumaar</span><span class="_zxst">3:20</span></div></a></li>
        <li><a class="songname" zx-ds="https://shorturl.at/BUVZ4" zx-lyr="" zx-dsn="Heeriye" zx-dsan="Arijit Singh, Jasleen Royal" zx-dspu="https://shorturl.at/quXY3"><div class="impxz"><i class="arrow fa fa-play playbtn0"></i><img src="https://shorturl.at/quXY3"></div><div class="zxnn"><span class="_zxn">Heeriye</span><span class="_zxan">Arijit Singh, Jasleen Royal</span><span class="_zxst">3:14</span></div></a></li>
        <li><a class="songname" zx-ds="https://shorturl.at/DEFN5" zx-lyr="" zx-dsn="One Love" zx-dsan="Shubh" zx-dspu="https://shorturl.at/ozR01"><div class="impxz"><i class="arrow fa fa-play playbtn0"></i><img src="https://shorturl.at/ozR01"></div><div class="zxnn"><span class="_zxn">One Love</span><span class="_zxan">Shubh</span><span class="_zxst">2:39</span></div></a></li>
        <li><a class="songname" zx-ds="https://shorturl.at/aiFPU" zx-lyr="" zx-dsn="Shooting Star" zx-dsan="Angry Prash" zx-dspu="https://shorturl.at/buEFJ"><div class="impxz"><i class="arrow fa fa-play playbtn0"></i><img src="https://shorturl.at/buEFJ"></div><div class="zxnn"><span class="_zxn">Shooting Star</span><span class="_zxan">Angry Prash</span><span class="_zxst">3:11</span></div></a></li>
        <li><a class="songname" zx-ds="https://shorturl.at/gvT48" zx-lyr="" zx-dsn='Ordinary Person (From "Leo")' zx-dsan="Nikitha Gandhi, Anirudh Ravichander" zx-dspu="https://shorturl.at/kwzJ4"><div class="impxz"><i class="arrow fa fa-play playbtn0"></i><img src="https://shorturl.at/kwzJ4"></div><div class="zxnn"><span class="_zxn">Ordinary Person</span><span class="_zxan">Nikitha Gandhi, Anirudh Ravichander</span><span class="_zxst">2:18</span></div></a></li>
        <li><a class="songname" zx-ds="https://shorturl.at/dhmDE" zx-lyr="" zx-dsn="Badass" zx-dsan="Anirudh Ravichander" zx-dspu="https://shorturl.at/dAIU1"><div class="impxz"><i class="arrow fa fa-play playbtn0"></i><img src="https://shorturl.at/dAIU1"></div><div class="zxnn"><span class="_zxn">Badass</span><span class="_zxan">Anirudh Ravichander</span><span class="_zxst">3:49</span></div></a></li>
        <li><a class="songname" zx-ds="https://shorturl.at/lwNS5" zx-lyr="" zx-dsn="softly" zx-dsan="Karan Aujla, Ikky" zx-dspu="https://shorturl.at/aksAX"><div class="impxz"><i class="arrow fa fa-play playbtn0"></i><img src="https://shorturl.at/aksAX"></div><div class="zxnn"><span class="_zxn">softly</span><span class="_zxan">Karan Aujla, Ikky</span><span class="_zxst">2:35</span></div></a></li>
        <li><a class="songname" zx-ds="https://shorturl.at/tvETW" zx-lyr="" zx-dsn="Naa Ready" zx-dsan="Anirudh Ravichander, Asal Kolaar, Thalapathy Vijay" zx-dspu="https://shorturl.at/ghnu7"><div class="impxz"><i class="arrow fa fa-play playbtn0"></i><img src="https://shorturl.at/ghnu7"></div><div class="zxnn"><span class="_zxn">Naa Ready</span><span class="_zxan">Anirudh Ravichander, Asal Kolaar, Thalapathy Vijay</span><span class="_zxst">4:08</span></div></a></li>
        <li><a class="songname" zx-ds="https://shorturl.at/ahDSY" zx-lyr="" zx-dsn="Cheques" zx-dsan="Shubh" zx-dspu="https://shorturl.at/htuwH"><div class="impxz"><i class="arrow fa fa-play playbtn0"></i><img src="https://shorturl.at/htuwH"></div><div class="zxnn"><span class="_zxn">Cheques</span><span class="_zxan">Shubh</span><span class="_zxst">3:03</span></div></a></li>
        <li><a class="songname" zx-ds="https://shorturl.at/ABS48" zx-lyr="" zx-dsn="Maan Meri Jaan" zx-dsan="King" zx-dspu="https://shorturl.at/ekFO2"><div class="impxz"><i class="arrow fa fa-play playbtn0"></i><img src="https://shorturl.at/ekFO2"></div><div class="zxnn"><span class="_zxn">Maan Meri Jaan</span><span class="_zxan">King</span><span class="_zxst">3:14</span></div></a></li>
    </ul> 
    </div>    
      </div>
      </div>
    </div>
    <div id="audio-container" class="player paused">
      <div class="album">
          <div class="cover">
             <img id="songProfileImageUrl" class="songProfileImage" src="./assets/bg.jpg">
          </div>
      </div>
      <div class="ftlpy">
          <div class="info">
              <div class="song-intro">
                  <h2 class="song-title" id="songName">Song</h2>
                  <h4 class="song-maker" id="artistName">Artist</h4>
              </div>
            </div>
          
          <div class="actions" >
            <div class="time">
              <span class="current-time">0:00</span>
              <span class="progress"><span></span></span>
              <span class="duration">-:--</span>
            </div>
            <div align="center">
              <button class=" button0 lyrics" name="lyrics" title="lyrics">
                <div class="arrow"><i class="fax fa fa-music"></i></div>
                  <div class="arrow"></div>
                </button>
              <button class=" button0 shuffle">
                <div class="arrow"><i class="fax fa fa-random"></i></div>
                  <div class="arrow"></div>
                </button>
              <button class="button0 button rw">
                <div class="arrow"><i class="fax fa fa-backward"></i></div>
                <div class="arrow"></div>
              </button>
              <button id="fa-play" class=" button0 play-pause arrow fax fa fa-play" onclick="playFunction()">
              </button>
              <button class="button0 button ff">
                  <div class="arrow"><i class="fax fa fa-forward"></i></div>
                  <div class="arrow"></div>
              </button>
              <button class="repeat button0"><i class="fax fa fa-repeat"></i></button>
              <button class="button0"><a href="" download="" onclick="downloadFunction()" id="downloadawd" class="download"><i class="fax fa fa-download"></i></a></button>
            </div>
          </div>
      </div>
      <audio id="myaudio" src=""></audio>
  </div>
  
  <div id="snackbar">Song downloaded. Please check your download folder.</div>
  <div id="lyrics"></div>
  <script>
    document.addEventListener('DOMContentLoaded', function () {
        // Read the song data from the cookie
        const cookies = document.cookie.split(';');
        let songData = null;

        for (let i = 0; i < cookies.length; i++) {
            const cookie = cookies[i].trim();
            if (cookie.startsWith('songData=')) {
                songData = decodeURIComponent(cookie.substring('songData='.length, cookie.length));
                break;
            }
        }

        if (songData) {
            const [ds, sn, dsan, dspu,dslyr] = songData.split('|');

            document.getElementById('songName').textContent = sn;
            document.getElementById('artistName').textContent = dsan;
            document.getElementById('songProfileImageUrl').src = dspu;

            const audio = document.getElementById('myaudio');
            const lyricsDiv = document.getElementById('lyrics');

            function updateAudioSource(ds) {
                audio.src = `${ds}`;
                console.log(`@File: ${sn}.mp3\n@Name: ${sn} \n@Artist: ${dsan} \nGET|200`);

                const downloadLink = document.querySelector('.download');
                downloadLink.href = `${ds}`;
                downloadLink.download = `${sn}.mp3`;
            }

            updateAudioSource(ds);

            function updateLyricsSource(dslyr) {
            fetchLyrics(dslyr)
                .then(parsedLyrics => {
                    // Update lyrics on audio time update
                    audio.addEventListener('timeupdate', function () {
                        const currentTime = audio.currentTime;
                        const currentLyric = parsedLyrics.find(lyric => timeToSeconds(lyric.time) > currentTime);

                        if (currentLyric) {
                            // Display lyrics with current time bold
                            lyricsDiv.innerHTML = parsedLyrics.map(lyric => {
                                const timeInSeconds = timeToSeconds(lyric.time);
                                const isBold = timeInSeconds <= currentTime && timeInSeconds + 3 > currentTime;
                                return `<span class="${isBold ? 'bold' : ''}">${lyric.text}</span><br>`;
                            }).join('');
                        }
                    });
                })
                .catch(error => {
                    console.error(`Error fetching or parsing lyrics: ${error}`);
                });
        }

        updateLyricsSource(dslyr);
    } else {
        // Handle the case when no song data is available
    }
});

function fetchLyrics(lyricsFile) {
        return fetch(lyricsFile)
            .then(response => {
                if (!response.ok) {
                    throw new Error(`Failed to fetch lyrics: ${response.statusText}`);
                }
                return response.text();
            })
            .then(lyrics => {
                // Parse the lyrics into an array of objects
                const parsedLyrics = lyrics.split('\n').map(line => {
                    const match = line.match(/^\[(\d+:\d+)\]\s*(.*)/);
                    return match ? { time: match[1], text: match[2] } : null;
                }).filter(Boolean);

                return parsedLyrics;
            });
    }

function timeToSeconds(time) {
    const [minutes, seconds] = time.split(':').map(Number);
    return minutes * 60 + seconds;
}

    function downloadFunction() {
        const snackbar = document.getElementById('snackbar');
        snackbar.classList.add('show');

        setTimeout(function () {
            snackbar.classList.remove('show');
        }, 3000);
    }
</script>

    <script src='https://code.jquery.com/jquery-2.2.4.min.js'></script>
    <script  src="./js/script.js"></script>
    <script src="./js/index.js"></script>
    <script src="./js/menuBar.js"></script>
    
</body>
</html>
